import{r as a,h as n,H as h,g as d}from"./preview-4P8FO6WR.js";import{H as c,i as u}from"./index-d2fc6ec0-C5cwWy5q.js";import{D as p}from"./mg-menu.conf-9609bcb2-CVytr2H4.js";import"./index-FwRSe4z1.js";import"./_commonjsHelpers-BosuxZz1.js";import"./preview-errors-Dg5lG0lC.js";import"./index-DrFu-skq.js";import"./index.es-BUUxBfzo.js";import"./iframe-BmywqEBX.js";import"../sb-preview/runtime.js";const f=t=>t.nodeName==="MG-ITEM-MORE";var o;(function(t){t.BASE_INDEX="data-overflow-base-index",t.PROXY_INDEX="data-overflow-proxy-index"})(o||(o={}));class g{constructor(l,r){this.element=l,this.render=r,this.disconnect=()=>{this._resizeObserver.disconnect()},this.run=i=>{this._moreElement===void 0&&(this._moreElement=this.render(),this._baseChildren=this.getInteractiveItems(this.element),f(this._moreElement)&&(this._proxyChildren=this.getInteractiveItems(this._moreElement.shadowRoot.querySelector("mg-menu"))),this._baseChildren.forEach((e,s)=>{e.setAttribute(o.BASE_INDEX,`${s}`),this._proxyChildren[s].setAttribute(o.PROXY_INDEX,`${s}`)})),i!==void 0&&this.updateDisplayedItems(i)},this.getInteractiveItems=i=>{var e;return(((e=i.children)===null||e===void 0?void 0:e.length)>0?Array.from(i.children):[]).filter(s=>["MG-MENU-ITEM","MG-BUTTON"].includes(s.nodeName))},this.updateDisplayedItems=i=>{this.restoreItems();const e={accWidth:0,previousItem:null};[...this._baseChildren,this._moreElement].forEach(s=>{e.accWidth+=s.offsetWidth;const m=e.previousItem!==null&&e.previousItem.getAttribute("hidden")!==null;this.toggleItem(s,m&&!this.isMoreElement(s)||this.isOverflowElement(e.accWidth,s,i)||this.isMoreElement(s)&&!m),e.previousItem=s})},this.isOverflowElement=(i,e,s)=>e.previousElementSibling===null||this.isMoreElement(e)?!1:this.isMoreElement(e.nextElementSibling)?i>s:i+this._moreElement.offsetWidth>s,this.isMoreElement=i=>i.nodeName==="MG-ITEM-MORE",this.toggleItem=(i,e)=>{const s=Number(i.getAttribute(o.BASE_INDEX));this.isMoreElement(i)?this.toggleElement(this._moreElement,e):s>=0&&(this.toggleElement(i,e),this.toggleElement(this._proxyChildren[s],!e))},this.toggleElement=(i,e)=>{e?i.setAttribute("hidden",""):i.removeAttribute("hidden")},this.restoreItems=()=>{[...this._baseChildren,this._moreElement].forEach(i=>i.removeAttribute("hidden"))},this._resizeObserver===void 0&&(this._resizeObserver=new ResizeObserver(i=>{i.forEach(e=>{this.run(e.contentRect.width)})}),this._resizeObserver.observe(this.element)),this.run()}}const E=".mg-u-visually-hidden{position:absolute !important;overflow:hidden !important;width:.1rem !important;height:.1rem !important;padding:0 !important;border:0 !important;margin:-0.1rem !important;clip:rect(0.1rem, 0.1rem, 0.1rem, 0.1rem) !important;clip-path:inset(50%) !important;white-space:nowrap !important}*:focus:not(:focus-visible){outline:none}@media (prefers-reduced-motion){*{animation:none !important;transition:none !important}}:host:not([hidden]){display:flex}",v=E,M=class{constructor(t){a(this,t),this.name="mg-item-more",this.canRenderMgMenuItemOverflowElement=!0,this.renderMgMenuItemOverflowElement=()=>{this.parentMenuItems.forEach(r=>{this.moreElementMenuItem.querySelector("mg-menu").appendChild(r.cloneNode(!0))});const l=Array.from(this.parentMenu.querySelectorAll("mg-menu-item:not([data-overflow-more])"));return Array.from(this.moreElementMenuItem.querySelectorAll("mg-menu-item:not([data-overflow-more])")).forEach((r,i)=>{r.addEventListener("click",()=>{const e=l[i].shadowRoot.querySelector("a, button");(e instanceof HTMLButtonElement||e instanceof HTMLAnchorElement)&&e.click()}),c(r.id)&&(r.id=`${r.id}-proxy`),l[i].addEventListener("status-change",e=>{r.setAttribute("status",e.detail)})}),this.element},this.icon={icon:"ellipsis-vertical"},this.slotlabel={display:!1},this.size=void 0,this.parentMenu=void 0}validateIcon(t){if(typeof t!="object"||typeof t=="object"&&typeof t.icon!="string")throw new Error(`<${this.name}> prop "icon" must match MgItemMore['icon'] type.`)}validateSlotLabel(t){if(typeof t!="object"||typeof t=="object"&&typeof t.display!="boolean")throw new Error(`<${this.name}> prop "slotlabel" must match MgItemMore['slotlabel'] type.`);typeof t.label!="string"&&(this.slotlabel.label=this.messages.moreLabel)}validateSize(t){if(t&&typeof t!="string")throw new Error(`<${this.name}> prop "size" must match MgItemMore['size'] type.`)}componentWillLoad(){this.messages=u(this.element).messages.plusMenu,this.validateIcon(this.icon),this.validateSlotLabel(this.slotlabel),this.validateSize(this.size)}componentDidLoad(){return setTimeout(()=>{this.parentMenu=this.element.closest("mg-menu")})}componentDidUpdate(){this.parentMenu&&this.canRenderMgMenuItemOverflowElement&&(this.parentMenuItems=Array.from(this.parentMenu.children).filter(t=>t.nodeName==="MG-MENU-ITEM"),this.overflowBehavior=new g(this.parentMenu,this.renderMgMenuItemOverflowElement),this.canRenderMgMenuItemOverflowElement=!1)}disconnectedCallback(){var t;(t=this.overflowBehavior)===null||t===void 0||t.disconnect()}render(){return n(h,{key:"2dfe9d844f42403de5120e0db85f3617d9d580a8",role:"listitem"},this.parentMenu&&n("mg-menu-item",{"data-overflow-more":!0,"data-size":this.parentMenu.size,ref:t=>{t&&(this.moreElementMenuItem=t)}},n("mg-icon",{icon:this.icon.icon,slot:"image"}),n("span",{class:{"mg-u-visually-hidden":!this.slotlabel.display},slot:"label"},this.slotlabel.label),n("mg-menu",{direction:p.VERTICAL,label:this.messages.moreLabel,size:this.size})))}get element(){return d(this)}static get watchers(){return{icon:["validateIcon"],slotlabel:["validateSlotLabel"],size:["validateSize"]}}};M.style=v;export{M as mg_item_more};
